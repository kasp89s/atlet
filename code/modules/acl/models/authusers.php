<?php/** * Модель данных. ACL. Пользователи * */class AuthUsers_Model extends Model  {	public $table_name = 'auth_users';    function get_roles($user_id = FALSE){    	if(!$user_id) return FALSE;    	$query = $this->db    		->select(Array('id' => 'self.id', 'name' => 'self.name'))        	->from(Array('ml_self'=>'auth_roles'))        	->left_join(Array('ml_rel' => 'auth_roles_users'), 'rel.role_id', 'self.id')			->where('rel.user_id',  '=', $user_id)        	->order_by('self.id');        return $query->get()->rows();    }	/**	 * Добавить роль $role_id для пользователя $user_id	 *	 * @param int(array) $role_id	 * @param int $user_id	 */	public function add_role($user_id = FALSE, $role_id = FALSE){		if(!$role_id || !$user_id)			return FALSE;		if(is_array($role_id)) {			foreach ($role_id as $v){				$this->db->insert('auth_roles_users', array(					'role_id' => $v,					'user_id' => $user_id				))->get();			}		} else {			$this->db->insert('auth_roles_users', array(				'role_id' => $role_id,				'user_id' => $user_id			))->get();		}	}	/**	 * Очистить список ролдей пользователя $user_id	 *	 * @param int $role_id	 */	public function clear_roles($user_id = FALSE){		if(!$user_id) return FALSE;		$this->db->delete('auth_roles_users', array('user_id' => $user_id))->get();	}}